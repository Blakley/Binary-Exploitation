import os
import sys
import gdb

answer_list = []

class level_1(gdb.Command):
	def __init__(self):
		super(level_1, self).__init__("level_1", gdb.COMMAND_DATA)

	def invoke(self, arg, from_tty):
		def breakPoint():
			gdb.execute('b failed')			# b1: incorrect input			
			gdb.execute('b level_2')		# b2: correct input
				
		# test to see if answer was reached
		def test(value):		
			res = gdb.execute("info b 2", False, True)
			if ('hit' in res):
				print("Found level 1 answer: ", value)
				return True
			return False

		# find the answer
		def find():
			for i in range(1, 100):				
				if os.path.exists("answers.txt"):
					os.remove("answers.txt")
				
				with open("answers.txt", "a+") as res:
					res.write(str(i))
					print('Testing input: ' + str(i))

				gdb.execute('run < answers.txt')

				if test(i) == True:
					answer_list.append(i);
					break
					
		breakPoint()
		find()

class Start(gdb.Command):
	def __init__(self):
		super(Start, self).__init__("start", gdb.COMMAND_DATA)
	
	def invoke(self, arg, from_tty):
		level_1();
		gdb.execute('level_1')

Start()
